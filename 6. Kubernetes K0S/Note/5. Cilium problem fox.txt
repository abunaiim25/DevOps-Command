perfect üòé
‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶ö‡¶æ‡¶á‡¶õ‡ßã **Helm ‡¶¶‡¶ø‡ßü‡ßá‡¶á Cilium + Hubble install ‡¶ï‡¶∞‡¶§‡ßá**, ‡¶Ö‡¶∞‡ßç‡¶•‡¶æ‡ßé k0s.yaml ‡¶è‡¶∞ internal config ‡¶®‡¶æ, ‡¶¨‡¶∞‡¶Ç manually helm deploy route.
‡¶§‡¶æ‡¶π‡¶≤‡ßá ‡¶®‡¶ø‡¶ö‡ßá ‡¶Ü‡¶Æ‡¶ø ‡¶¶‡¶ø‡¶ö‡ßç‡¶õ‡¶ø **one-shot clean + helm deploy** process ‚Äî ‡¶Ø‡ßá‡¶ü‡¶æ ‡ßß‡ß¶‡ß¶% port conflict fix ‡¶ï‡¶∞‡¶¨‡ßá üî•

---

## üßº STEP‚Äì1: ‡¶™‡ßÅ‡¶∞‡ßã‡¶®‡ßã Cilium, Hubble, leftover ‡¶∏‡¶¨ ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡ßã

```bash
helm uninstall cilium -n kube-system || true
sudo pkill -f cilium
sudo pkill -f hubble
sudo pkill -f cilium-agent
sudo pkill -f cilium-operator

sudo ip link delete cilium_host 2>/dev/null
sudo ip link delete cilium_net 2>/dev/null
sudo ip link delete cilium_vxlan 2>/dev/null
sudo ip link delete cilium_health 2>/dev/null
sudo ip link delete cilium_lxc 2>/dev/null

sudo rm -rf /var/lib/cilium /etc/cilium /opt/cni/bin/cilium-cni
```

---

## üßπ STEP‚Äì2: check k0s cluster ‡¶†‡¶ø‡¶ï‡¶†‡¶æ‡¶ï ‡¶ö‡¶≤‡¶õ‡ßá ‡¶ï‡¶ø‡¶®‡¶æ

```bash
sudo systemctl restart k0scontroller
sudo k0s status
export KUBECONFIG=/var/lib/k0s/pki/admin.conf
kubectl get nodes
```

> Node status ‡¶Ø‡¶¶‡¶ø **Ready** ‡¶®‡¶æ ‡¶¶‡ßá‡¶ñ‡¶æ‡ßü, ‡¶§‡¶æ‡¶π‡¶≤‡ßá ‡¶ï‡ßá‡¶¨‡¶≤ ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤‡¶æ‡¶∞ restart ‡¶ï‡¶∞‡ßã:

```bash
sudo systemctl restart k0scontroller
```

---

## ‚öôÔ∏è STEP‚Äì3: Cilium values file ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßã

```bash
sudo nano /home/naiim/cilium-values.yaml
```

‡¶≠‡ßá‡¶§‡¶∞‡ßá ‡¶®‡¶ø‡¶ö‡ßá‡¶∞‡¶ü‡¶æ paste ‡¶ï‡¶∞‡ßã üëá

```yaml
kubeProxyReplacement: strict
k8sServiceHost: 127.0.0.1
k8sServicePort: 6443

operator:
  enabled: true
  replicas: 1
  hostPort: true
  hostPortPort: 9965   # changed to avoid conflict

hubble:
  enabled: true
  relay:
    enabled: true
  ui:
    enabled: true
    hostPort: true
    hostPortPort: 9966   # changed to avoid conflict

securityContext:
  capabilities:
    ciliumAgent: [ "NET_ADMIN", "SYS_MODULE" ]
```

save ‚Üí exit (`Ctrl+O`, `Enter`, `Ctrl+X`)

---

## üöÄ STEP‚Äì4: Helm ‡¶¶‡¶ø‡ßü‡ßá Deploy ‡¶ï‡¶∞‡ßã

```bash
helm repo add cilium https://helm.cilium.io/
helm repo update

helm install --install cilium cilium/cilium \
  --version 1.15.0 \
  --namespace kube-system \
  --create-namespace \
  -f /home/naiim/cilium-values.yaml
```

---

## üßæ STEP‚Äì5: Verify pods status

```bash
kubectl get pods -n kube-system
```

‡¶∏‡¶¨ `Running` ‡¶¨‡¶æ `Completed` ‡¶π‡¶ì‡ßü‡¶æ ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞‡•§
‡¶Ø‡¶¶‡¶ø ‡¶ï‡ßã‡¶®‡ßã pod `Pending` ‡¶¨‡¶æ `FailedScheduling` ‡¶¶‡ßá‡¶ñ‡¶æ‡ßü, ‡¶è‡¶á ‡¶ï‡¶Æ‡¶æ‡¶®‡ßç‡¶°‡ßá debug ‡¶ï‡¶∞‡ßã üëá

```bash
kubectl describe pod <pod-name> -n kube-system | grep -A5 "Events"
```

---

## üåê STEP‚Äì6: Hubble UI Access

```bash
kubectl port-forward -n kube-system svc/hubble-ui 12000:8081
```

Browser ‚Üí [http://localhost:12000](http://localhost:12000)

---

‚úÖ ‡¶è‡¶ñ‡¶® ‡¶Ü‡¶∞ ‚Äúnode(s) didn‚Äôt have free ports for the requested pod ports‚Äù ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá ‡¶®‡¶æ‡•§

---

‡¶ö‡¶æ‡¶ì ‡¶Ü‡¶Æ‡¶ø ‡¶è‡¶á ‡¶™‡ßÅ‡¶∞‡ßã process-‡¶ü‡¶æ ‡¶è‡¶ï‡¶ü‡¶æ **bash script (clean + deploy)** ‡¶Ü‡¶ï‡¶æ‡¶∞‡ßá ‡¶¨‡¶æ‡¶®‡¶ø‡ßü‡ßá ‡¶¶‡¶ø‡¶á ‡¶Ø‡¶æ‡¶§‡ßá ‡¶è‡¶ï‡¶¨‡¶æ‡¶∞‡ßá ‡¶∞‡¶æ‡¶® ‡¶ï‡¶∞‡¶≤‡ßá‡¶á ready ‡¶π‡ßü‡ßá ‡¶Ø‡¶æ‡ßü?
