ржПржХржжржо ржкрж╛рж░ржлрзЗржХрзНржЯ ржнрж╛ржЗ ЁЯШО
рждрзБржорж┐ basically ржЪрж╛ржУ тЖТ **Keycloak + Database (PostgreSQL)** Kubernetes-ржП deploy ржХрж░рждрзЗ **Helm** ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗред
ржЪрж▓рзЛ ржПржХржжржо practical way-рждрзЗ ржзрж╛ржкрзЗ ржзрж╛ржкрзЗ ржжрзЗржЦрж┐ ржХрж┐ржнрж╛ржмрзЗ ржХрж░рж╛ ржпрж╛рзЯ ЁЯТе

---

## ЁЯЪА рж▓ржХрзНрж╖рзНржп

рждрзБржорж┐ ржПржХржЯрж╛ Kubernetes ржХрзНрж▓рж╛рж╕рзНржЯрж╛рж░рзЗ **Keycloak** install ржХрж░ржмрзЗ,
ржпрзЗржЦрж╛ржирзЗ database (PostgreSQL) рж╣ржмрзЗ **Helm chart ржПрж░ ржоржзрзНржпрзЗржЗ** configure ржХрж░рж╛ред

---

## ЁЯз▒ Step 1: Prerequisites

ржкрзНрж░ржержорзЗ ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рзЛ ржирж┐ржЪрзЗрж░ ржЬрж┐ржирж┐рж╕ржЧрзБрж▓рзЛ ready ржЖржЫрзЗ:

```bash
kubectl version --client
helm version
```

Cluster ready ржХрж┐ржирж╛ ржжрзЗржЦрзЛ:

```bash
kubectl get nodes
```

---

## ЁЯз░ Step 2: Namespace рждрзИрж░рж┐ ржХрж░рзЛ

```bash
kubectl create namespace keycloak
```

---

## ЁЯУж Step 3: Bitnami Helm Repo ржпрзЛржЧ ржХрж░рзЛ

Bitnami-ржПрж░ chart-ржЧрзБрж▓рзЛ stable ржУ production-readyред

```bash
helm repo add bitnami https://charts.bitnami.com/bitnami
helm repo update
```

---

## тЪЩя╕П Step 4: Custom Configuration (values.yaml)

ржПржХржЯрж╛ `values.yaml` ржлрж╛ржЗрж▓ рждрзИрж░рж┐ ржХрж░рзЛ ЁЯСЗ

```yaml
# values.yaml
auth:
  adminUser: admin
  adminPassword: admin123

# PostgreSQL configuration (internal)
postgresql:
  enabled: true
  auth:
    postgresPassword: keycloak
    username: keycloak
    password: keycloakpass
    database: keycloakdb

# Service expose type
service:
  type: LoadBalancer
  ports:
    http: 8080
    https: 8443

# Optional resource limit (good practice)
resources:
  requests:
    memory: 512Mi
    cpu: 250m
  limits:
    memory: 1Gi
    cpu: 500m

# Optional: Enable Ingress if you want domain-based access
ingress:
  enabled: false  # later true korbe jodi nginx ingress thake
```

---

## ЁЯЪА Step 5: Helm ржжрж┐рзЯрзЗ Install ржХрж░рзЛ

ржПржЦржи рж╕рж░рж╛рж╕рж░рж┐ deploy ржХрж░рзЛ ЁЯСЗ

```bash
helm install keycloak bitnami/keycloak \
  --namespace keycloak \
  -f values.yaml
```

---

## ЁЯФН Step 6: Check Deployment Status

Pods ржПржмржВ Services ржЪрзЗржХ ржХрж░рзЛ:

```bash
kubectl get pods -n keycloak
kubectl get svc -n keycloak
```

тЬЕ Example output:

```
NAME                         READY   STATUS    RESTARTS   AGE
keycloak-0                   1/1     Running   0          2m
keycloak-postgresql-0        1/1     Running   0          2m
```

рждрж╛рж╣рж▓рзЗ ржмрзБржЭрзЗ ржирж╛ржУ тАФ Keycloak ржПржмржВ PostgreSQL ржжрзБржЯрзЛржЗ ржарж┐ржХржарж╛ржХ ржЪрж▓ржЫрзЗ! ЁЯОп

---

## ЁЯМР Step 7: Access the Keycloak UI

ржпржжрж┐ LoadBalancer ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЛ (ржпрзЗржоржи cloud cluster рж╣рж▓рзЗ):

```bash
kubectl get svc -n keycloak
```

рждрж╛рж╣рж▓рзЗ ржПрж░ржХржо ржХрж┐ржЫрзБ ржжрзЗржЦржмрзЗ ЁЯСЗ

```
NAME       TYPE           CLUSTER-IP     EXTERNAL-IP      PORT(S)          AGE
keycloak   LoadBalancer   10.96.1.12     34.67.123.45     8080:30256/TCP   3m
```

ржПржЦржи browser ржП ржпрж╛ржУ:

```
http://<EXTERNAL-IP>:8080
```

Login ржХрж░рзЛ ЁЯСЗ

```
Username: admin
Password: admin123
```

---

## ЁЯза Step 8 (Optional): External Database ржЪрж╛ржЗрж▓рзЗ

ржпржжрж┐ рждрзБржорж┐ external PostgreSQL ржмрж╛ MySQL use ржХрж░рждрзЗ ржЪрж╛ржУ,
рждрж╛рж╣рж▓рзЗ internal PostgreSQL disable ржХрж░рзЗ external database info ржжрж╛ржУ ЁЯСЗ

```bash
postgresql:
  enabled: false

externalDatabase:
  host: mydb-host
  port: 5432
  user: keycloak
  password: keycloakpass
  database: keycloakdb
```

рждрж╛рж░ржкрж░ redeploy ржХрж░рзЛ ЁЯСЗ

```bash
helm upgrade keycloak bitnami/keycloak -n keycloak -f values.yaml
```

---

## тЬЕ Step 9: Verify Connectivity

Keycloak log ржжрзЗржЦрждрзЗ ржкрж╛рж░рзЛ:

```bash
kubectl logs -f keycloak-0 -n keycloak
```

PostgreSQL pod log ржжрзЗржЦрждрзЗ:

```bash
kubectl logs -f keycloak-postgresql-0 -n keycloak
```

---

## ЁЯФР Final Result

ЁЯОЙ рждрзЛржорж╛рж░ Kubernetes-ржП ржПржЦржи Keycloak ржЪрж▓ржмрзЗ PostgreSQL database рж╕рж╣, Helm ржжрж┐рзЯрзЗ ржПржХржжржо clean deploy ржХрж░рж╛ред
`keycloak` namespace-ржП ржжрзБржЗржЯрж╛ pod ржерж╛ржХржмрзЗ тАФ

* `keycloak-0` тЖТ Keycloak service
* `keycloak-postgresql-0` тЖТ PostgreSQL database

---

рждрзБржорж┐ ржХрж┐ ржЪрж╛ржУ ржЖржорж┐ ржПржЦржи ржПржЗ setup-ржПрж░ рж╕ржЩрзНржЧрзЗ ржПржХржЯрж╛ **Ingress + HTTPS (Let's Encrypt)** ржпрзБржХрзНржд ржХрж░рзЗ ржжрж┐ржЗ,
ржпрж╛рждрзЗ рждрзБржорж┐ `https://keycloak.example.com` ржжрж┐рзЯрзЗ access ржХрж░рждрзЗ ржкрж╛рж░рзЛ production style-ржП?
